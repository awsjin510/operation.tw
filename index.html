<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ“ä½œä¸€ä¸‹ | operation.tw</title>
<meta name="description" content="é›²ç«¯ã€è³‡å®‰ã€AIã€é–±è®€ã€æˆé•· â€” ç°¡å–®çš„äº‹æƒ…å°ˆæ³¨åš">
<meta name="google-site-verification" content="9ShlnwY0Iih64Jujj5Xy7eyWDLOO58-NMcPKJELY6eA" />
<link rel="canonical" href="https://operation.tw/">
<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:site_name" content="æ“ä½œä¸€ä¸‹">
<meta property="og:title" content="æ“ä½œä¸€ä¸‹ | operation.tw">
<meta property="og:description" content="é›²ç«¯ã€è³‡å®‰ã€AIã€é–±è®€ã€æˆé•· â€” ç°¡å–®çš„äº‹æƒ…å°ˆæ³¨åš">
<meta property="og:url" content="https://operation.tw/">
<meta property="og:image" content="https://operation.tw/default.png">
<meta property="og:locale" content="zh_TW">
<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="æ“ä½œä¸€ä¸‹ | operation.tw">
<meta name="twitter:description" content="é›²ç«¯ã€è³‡å®‰ã€AIã€é–±è®€ã€æˆé•· â€” ç°¡å–®çš„äº‹æƒ…å°ˆæ³¨åš">
<meta name="twitter:image" content="https://operation.tw/default.png">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","name":"æ“ä½œä¸€ä¸‹","alternateName":"operation.tw","url":"https://operation.tw","description":"é›²ç«¯ã€è³‡å®‰ã€AIã€é–±è®€ã€æˆé•· â€” ç°¡å–®çš„äº‹æƒ…å°ˆæ³¨åš","inLanguage":"zh-TW","author":{"@type":"Person","name":"æ“ä½œä¸€ä¸‹","url":"https://operation.tw"},"potentialAction":{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://operation.tw/#/search/{search_term_string}"},"query-input":"required name=search_term_string"}}
</script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700;900&family=Share+Tech+Mono&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
<style>
:root{
  --cyan:#00f5ff;--pink:#ff0080;--purple:#bf00ff;
  --yellow:#ffff00;--green:#00ff88;
  --bg:#050510;--bg2:#0a0a1a;--bg3:#0d0d22;--bg4:#111128;
  --border:rgba(0,245,255,0.1);--border2:rgba(0,245,255,0.3);
  --text:#e0e0ff;--dim:#6060a0;--mid:#9090cc;
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--bg);color:var(--text);font-family:'Noto Sans TC',sans-serif;line-height:1.8;min-height:100vh;}
body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(0,245,255,.05) 1px,transparent 1px),linear-gradient(90deg,rgba(0,245,255,.05) 1px,transparent 1px);background-size:40px 40px;pointer-events:none;z-index:0;}
body::after{content:'';position:fixed;inset:0;background:repeating-linear-gradient(0deg,transparent,transparent 3px,rgba(0,0,0,.06) 3px,rgba(0,0,0,.06) 4px);pointer-events:none;z-index:0;}

/* NAV */
nav{position:sticky;top:0;z-index:100;background:rgba(5,5,16,.93);backdrop-filter:blur(12px);border-bottom:1px solid var(--border);}
.nav-inner{max-width:1100px;margin:0 auto;padding:0 24px;height:60px;display:flex;align-items:center;justify-content:space-between;gap:16px;}
.nav-logo{font-family:'Orbitron',monospace;font-weight:900;font-size:.85rem;letter-spacing:.15em;color:var(--cyan);text-shadow:0 0 10px var(--cyan);text-decoration:none;cursor:pointer;flex-shrink:0;}
.nav-links{display:flex;align-items:center;gap:24px;}
.nav-links button{font-family:'Share Tech Mono',monospace;font-size:.72rem;color:var(--dim);background:none;border:none;cursor:pointer;letter-spacing:.1em;text-transform:uppercase;transition:color .25s;}
.nav-links button:hover{color:var(--cyan);}
.nav-podcast{font-family:'Share Tech Mono',monospace;font-size:.72rem;color:var(--dim);text-decoration:none;letter-spacing:.1em;text-transform:uppercase;transition:color .25s;}
.nav-podcast:hover{color:var(--cyan);}
.nav-search{display:flex;align-items:center;gap:6px;background:rgba(255,255,255,.04);border:1px solid var(--border);padding:5px 12px;}
.nav-search input{background:transparent;border:none;outline:none;color:var(--text);font-family:'Share Tech Mono',monospace;font-size:.72rem;width:130px;}
.nav-search input::placeholder{color:var(--dim);}
.hamburger{display:none;flex-direction:column;gap:4px;cursor:pointer;padding:4px;background:none;border:none;}
.hamburger span{width:20px;height:1px;background:var(--cyan);display:block;}

/* MOBILE MENU */
.mob-menu{display:none;position:fixed;top:60px;left:0;right:0;bottom:0;background:rgba(5,5,16,.98);z-index:99;padding:28px 24px;flex-direction:column;gap:0;}
.mob-menu.open{display:flex;}
.mob-menu button{font-family:'Share Tech Mono',monospace;font-size:.88rem;color:var(--mid);background:none;border:none;border-bottom:1px solid var(--border);cursor:pointer;letter-spacing:.1em;text-align:left;padding:16px 0;text-transform:uppercase;}
.mob-search{display:flex;background:rgba(255,255,255,.04);border:1px solid var(--border);padding:10px 14px;margin-bottom:20px;}
.mob-search input{background:transparent;border:none;outline:none;color:var(--text);font-family:'Share Tech Mono',monospace;font-size:.82rem;flex:1;}

/* VIEWS */
.view{display:none;position:relative;z-index:1;}
.view.active{display:block;}

/* HERO */
.hero{padding:96px 24px 72px;text-align:center;position:relative;overflow:hidden;min-height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;}
.orb{position:absolute;border-radius:50%;filter:blur(80px);pointer-events:none;}
.orb1{width:600px;height:600px;background:rgba(0,245,255,.09);top:-150px;left:-150px;animation:orb-float 12s ease-in-out infinite;}
.orb2{width:450px;height:450px;background:rgba(255,0,128,.07);bottom:-120px;right:-120px;animation:orb-float2 9s ease-in-out infinite;}
.orb3{width:320px;height:320px;background:rgba(191,0,255,.06);top:45%;left:55%;animation:orb-float 15s ease-in-out infinite reverse;}
@keyframes orb-float{0%,100%{transform:translate(0,0);}33%{transform:translate(30px,-20px);}66%{transform:translate(-20px,15px);}}
@keyframes orb-float2{0%,100%{transform:translate(0,0);}33%{transform:translate(-25px,20px);}66%{transform:translate(20px,-15px);}}
.hero-tag{font-family:'Share Tech Mono',monospace;font-size:.68rem;color:var(--pink);letter-spacing:.25em;text-transform:uppercase;margin-bottom:20px;}
.hero-brand{font-family:'Orbitron',monospace;font-weight:900;font-size:clamp(3.5rem,11vw,8rem);line-height:1;margin-bottom:12px;}
.hero-brand .t1{color:#fff;position:relative;}
.hero-brand .t1::before,.hero-brand .t1::after{content:attr(data-text);position:absolute;top:0;left:0;}
.hero-brand .t1::before{color:var(--pink);clip-path:polygon(0 0,100% 0,100% 35%,0 35%);animation:glA 4s infinite;opacity:0;}
.hero-brand .t1::after{color:var(--cyan);clip-path:polygon(0 65%,100% 65%,100% 100%,0 100%);animation:glB 4s infinite;opacity:0;}
@keyframes glA{0%,90%,100%{opacity:0;transform:none}91%{opacity:.7;transform:translate(-2px,1px)}93%{opacity:0}}
@keyframes glB{0%,94%,100%{opacity:0;transform:none}95%{opacity:.7;transform:translate(2px,-1px)}97%{opacity:0}}
.hero-brand .t2{color:var(--cyan);text-shadow:0 0 20px var(--cyan),0 0 60px rgba(0,245,255,.25);}
.hero-sub{font-family:'Share Tech Mono',monospace;font-size:.76rem;color:var(--dim);letter-spacing:.1em;margin-bottom:24px;}
.hero-quote{font-size:.98rem;color:var(--mid);max-width:480px;margin:0 auto 36px;line-height:2;}
.hero-cta{display:inline-flex;align-items:center;gap:10px;padding:12px 28px;border:1px solid var(--cyan);color:var(--cyan);font-family:'Share Tech Mono',monospace;font-size:.76rem;letter-spacing:.12em;text-transform:uppercase;cursor:pointer;transition:all .3s;background:transparent;}
.hero-cta:hover{background:var(--cyan);color:var(--bg);box-shadow:0 0 25px rgba(0,245,255,.4);}

/* SECTION */
.section{max-width:1100px;margin:0 auto;padding:60px 24px;}
.sec-hd{display:flex;align-items:flex-end;gap:16px;margin-bottom:32px;}
.sec-hd-text h2{font-family:'Orbitron',monospace;font-size:1rem;font-weight:700;color:#fff;margin-bottom:2px;}
.sec-hd-text .sec-sub{font-family:'Share Tech Mono',monospace;font-size:.6rem;color:var(--dim);letter-spacing:.12em;}
.sec-line{flex:1;height:1px;background:linear-gradient(to right,var(--border2),transparent);}

/* FILTER */
.filter-bar{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:24px;}
.fb{font-family:'Share Tech Mono',monospace;font-size:.63rem;padding:5px 14px;border:1px solid var(--border);color:var(--dim);cursor:pointer;letter-spacing:.08em;text-transform:uppercase;transition:all .2s;background:transparent;}
.fb:hover{border-color:var(--border2);color:var(--mid);}
.fb.on{border-color:var(--cyan);color:var(--cyan);background:rgba(0,245,255,.07);}

/* POST GRID */
.post-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:18px;}
.pc{background:var(--bg2);border:1px solid var(--border);cursor:pointer;transition:all .32s;position:relative;overflow:hidden;}
.pc::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,var(--cyan),transparent);transform:translateX(-100%);transition:transform .55s;}
.pc:hover::before{transform:translateX(100%);}
.pc:hover{border-color:var(--border2);transform:translateY(-4px);box-shadow:0 20px 40px rgba(0,0,0,.5);}
.pc-img{height:160px;background:var(--bg3);position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center;}
.pc-img img{width:100%;height:100%;object-fit:cover;}
.pc-img-ph{font-size:2.4rem;opacity:.15;}
.pc-badge{position:absolute;top:10px;left:10px;font-family:'Share Tech Mono',monospace;font-size:.57rem;padding:3px 8px;border:1px solid;letter-spacing:.1em;text-transform:uppercase;background:rgba(5,5,16,.75);}
.pc-body{padding:18px;}
.pc-title{font-size:.93rem;font-weight:700;color:var(--text);line-height:1.6;margin-bottom:8px;transition:color .2s;}
.pc:hover .pc-title{color:var(--cyan);}
.pc-exc{font-size:.8rem;color:var(--dim);line-height:1.75;margin-bottom:12px;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;}
.pc-foot{display:flex;align-items:center;justify-content:space-between;font-family:'Share Tech Mono',monospace;font-size:.6rem;color:var(--dim);}
.pc-rt{color:var(--cyan);}

/* EMPTY */
.empty-state{text-align:center;padding:60px 20px;color:var(--dim);}
.empty-state .ei{font-size:3rem;margin-bottom:12px;}
.empty-state p{font-family:'Share Tech Mono',monospace;font-size:.78rem;color:var(--mid);}

/* TOPICS */
.topic-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:14px;}
.tc{background:var(--bg2);border:1px solid var(--border);border-top-width:2px;padding:22px 14px;text-align:center;cursor:pointer;transition:all .28s;}
.tc:hover{transform:translateY(-3px);box-shadow:0 12px 28px rgba(0,0,0,.4);}
.tc-icon{font-size:1.7rem;margin-bottom:8px;display:inline-block;transition:transform .2s;}
.tc-name{font-family:'Orbitron',monospace;font-size:.7rem;font-weight:700;margin-bottom:5px;}
.tc-desc{font-size:.73rem;color:var(--dim);line-height:1.6;}
.tc-cnt{font-family:'Share Tech Mono',monospace;font-size:.58rem;margin-top:8px;padding:2px 8px;border:1px solid;display:inline-block;}

/* ABOUT */
.about-wrap{display:grid;grid-template-columns:auto 1fr;gap:48px;align-items:start;}
.avatar{width:150px;height:150px;flex-shrink:0;position:relative;display:flex;align-items:center;justify-content:center;}
.avatar-photo{width:112px;height:112px;border-radius:50%;object-fit:cover;object-position:center top;display:block;border:2px solid var(--cyan);box-shadow:0 0 0 4px rgba(0,245,255,.08),0 0 22px rgba(0,245,255,.55),0 0 55px rgba(0,245,255,.12);}
.avatar::before{content:'';position:absolute;inset:12px;border-radius:50%;border:1.5px dashed rgba(0,245,255,.6);animation:spin 4s linear infinite;}
.avatar::after{content:'';position:absolute;inset:0;border-radius:50%;border:1.5px solid transparent;border-top-color:rgba(255,0,128,.75);border-right-color:rgba(255,0,128,.75);animation:spin-rev 7s linear infinite;}
.avatar-ring{position:absolute;inset:-12px;border-radius:50%;border:1px solid transparent;border-bottom-color:rgba(191,0,255,.5);border-left-color:rgba(191,0,255,.5);animation:spin 13s linear infinite;}
@keyframes spin{to{transform:rotate(360deg);}}
@keyframes spin-rev{to{transform:rotate(-360deg);}}
.about-bio{font-size:.9rem;color:var(--mid);line-height:1.9;margin-bottom:20px;white-space:pre-line;}
.about-stats{display:flex;gap:28px;flex-wrap:wrap;}
.stat-n{font-family:'Orbitron',monospace;font-size:1.5rem;font-weight:900;color:var(--cyan);text-shadow:0 0 10px var(--cyan);}
.stat-l{font-family:'Share Tech Mono',monospace;font-size:.6rem;color:var(--dim);margin-top:2px;}

/* NEWSLETTER */
.nl{background:var(--bg2);border:1px solid var(--border);padding:52px 40px;text-align:center;position:relative;overflow:hidden;}
.nl::before{content:'';position:absolute;top:-1px;left:20%;right:20%;height:2px;background:linear-gradient(90deg,transparent,var(--cyan),transparent);}
.nl h2{font-family:'Orbitron',monospace;font-size:1.35rem;font-weight:900;color:#fff;margin-bottom:10px;}
.nl p{color:var(--dim);margin-bottom:24px;font-size:.88rem;}
.nl-form{display:flex;max-width:420px;margin:0 auto;}
.nl-in{flex:1;background:rgba(255,255,255,.04);border:1px solid var(--border);border-right:none;padding:11px 14px;color:var(--text);font-family:'Share Tech Mono',monospace;font-size:.76rem;outline:none;}
.nl-in:focus{border-color:var(--cyan);}
.nl-btn{padding:11px 22px;background:var(--cyan);color:var(--bg);font-family:'Share Tech Mono',monospace;font-size:.7rem;letter-spacing:.1em;text-transform:uppercase;border:none;cursor:pointer;white-space:nowrap;transition:all .25s;}
.nl-btn:hover{background:rgba(0,245,255,.15);color:var(--cyan);border:1px solid var(--cyan);}

/* FOOTER */
footer{border-top:1px solid var(--border);padding:28px 24px;text-align:center;font-family:'Share Tech Mono',monospace;font-size:.62rem;color:var(--dim);letter-spacing:.08em;position:relative;z-index:1;}

/* â•â•â• ARTICLE VIEW â•â•â• */
.art-wrap{max-width:740px;margin:0 auto;padding:48px 24px 80px;}
.art-back{display:inline-flex;align-items:center;gap:8px;font-family:'Share Tech Mono',monospace;font-size:.7rem;color:var(--dim);cursor:pointer;letter-spacing:.08em;margin-bottom:36px;transition:color .2s;background:none;border:none;}
.art-back:hover{color:var(--cyan);}
.art-cat-badge{font-family:'Share Tech Mono',monospace;font-size:.63rem;letter-spacing:.15em;text-transform:uppercase;padding:3px 10px;border:1px solid;display:inline-block;margin-bottom:14px;}
.art-title{font-family:'Orbitron',monospace;font-weight:900;font-size:clamp(1.6rem,4vw,2.5rem);color:#fff;line-height:1.25;margin-bottom:18px;}
.art-meta{display:flex;align-items:center;gap:18px;font-family:'Share Tech Mono',monospace;font-size:.63rem;color:var(--dim);margin-bottom:32px;padding-bottom:24px;border-bottom:1px solid var(--border);flex-wrap:wrap;}
.art-cover{width:100%;max-height:400px;object-fit:cover;border:1px solid var(--border);margin-bottom:32px;display:block;}

/* Article body */
.art-body{font-size:1rem;line-height:1.95;color:var(--text);}
.art-body p{margin-bottom:1.4em;}
.art-body h2{font-family:'Orbitron',monospace;font-size:1.2rem;color:var(--cyan);text-shadow:0 0 8px rgba(0,245,255,.25);margin:2.5em 0 .9em;padding-bottom:9px;border-bottom:1px solid var(--border);}
.art-body h3{font-family:'Orbitron',monospace;font-size:.95rem;color:var(--pink);margin:2em 0 .7em;}
.art-body a{color:var(--cyan);text-underline-offset:3px;transition:color .2s;}
.art-body a:hover{color:var(--pink);text-shadow:0 0 6px var(--pink);}
.art-body img{max-width:100%;border:1px solid var(--border);margin:1.4em 0;display:block;}
.art-body blockquote{border-left:3px solid var(--pink);background:rgba(255,0,128,.04);padding:14px 18px;margin:1.4em 0;color:var(--mid);}
.art-body pre{background:var(--bg3);border:1px solid var(--border);border-left:3px solid var(--cyan);padding:16px 18px;overflow-x:auto;margin:1.4em 0;font-family:'Share Tech Mono',monospace;font-size:.82rem;color:var(--green);}
.art-body code{font-family:'Share Tech Mono',monospace;font-size:.86em;color:var(--green);background:rgba(0,255,136,.06);padding:1px 5px;border:1px solid rgba(0,255,136,.12);}
.art-body pre code{background:none;border:none;padding:0;font-size:.85rem;}
.art-body ul,.art-body ol{padding-left:1.6em;margin-bottom:1.4em;}
.art-body li{margin-bottom:.4em;}
.art-body hr{border:none;height:1px;background:linear-gradient(90deg,transparent,var(--cyan),transparent);margin:2.5em 0;opacity:.35;}
.art-body strong{color:#fff;font-weight:700;}
.art-body em{color:var(--mid);}
.art-body table{width:100%;border-collapse:collapse;margin:1.4em 0;font-size:.88rem;}
.art-body th{background:var(--bg3);color:var(--cyan);font-family:'Share Tech Mono',monospace;padding:9px 14px;border:1px solid var(--border);text-align:left;font-size:.72rem;letter-spacing:.08em;}
.art-body td{padding:9px 14px;border:1px solid var(--border);color:var(--mid);}

/* Share */
.share-bar{display:flex;align-items:center;gap:10px;margin-top:40px;padding-top:24px;border-top:1px solid var(--border);flex-wrap:wrap;}
.share-label{font-family:'Share Tech Mono',monospace;font-size:.63rem;color:var(--dim);letter-spacing:.1em;}
.share-btn{font-family:'Share Tech Mono',monospace;font-size:.62rem;padding:5px 13px;border:1px solid var(--border);color:var(--mid);cursor:pointer;transition:all .2s;background:transparent;letter-spacing:.06em;}
.share-btn:hover{border-color:var(--cyan);color:var(--cyan);}

/* Related */
.related{margin-top:52px;padding-top:32px;border-top:1px solid var(--border);}
.related-lbl{font-family:'Share Tech Mono',monospace;font-size:.62rem;color:var(--dim);letter-spacing:.15em;text-transform:uppercase;margin-bottom:18px;}
.related-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px;}
.rel-card{background:var(--bg2);border:1px solid var(--border);padding:14px;cursor:pointer;transition:all .22s;}
.rel-card:hover{border-color:var(--border2);transform:translateY(-2px);}
.rel-cat{font-family:'Share Tech Mono',monospace;font-size:.57rem;letter-spacing:.1em;text-transform:uppercase;margin-bottom:5px;}
.rel-title{font-size:.82rem;font-weight:600;color:var(--text);line-height:1.5;}

/* â•â•â• SEARCH VIEW â•â•â• */
.search-wrap{max-width:760px;margin:0 auto;padding:48px 24px 80px;}
.search-title{font-family:'Orbitron',monospace;font-size:1rem;color:#fff;margin-bottom:22px;}
.search-box{display:flex;margin-bottom:24px;}
.search-box input{flex:1;background:var(--bg2);border:1px solid var(--border);border-right:none;padding:11px 16px;color:var(--text);font-family:'Share Tech Mono',monospace;font-size:.85rem;outline:none;}
.search-box input:focus{border-color:var(--cyan);}
.search-box button{padding:11px 18px;background:var(--cyan);color:var(--bg);border:none;font-family:'Share Tech Mono',monospace;font-size:.7rem;cursor:pointer;letter-spacing:.08em;text-transform:uppercase;}
.search-info{font-family:'Share Tech Mono',monospace;font-size:.65rem;color:var(--dim);margin-bottom:18px;letter-spacing:.06em;}

/* RESPONSIVE */
@media(max-width:900px){
  .topic-grid{grid-template-columns:repeat(3,1fr);}
}
@media(max-width:768px){
  .nav-links,.nav-search{display:none;}
  .hamburger{display:flex;}
  .hero{padding:60px 20px 48px;}
  .topic-grid{grid-template-columns:repeat(2,1fr);}
  .about-wrap{grid-template-columns:1fr;gap:22px;text-align:center;}
  .avatar{margin:0 auto;}
  .about-stats{justify-content:center;}
  .nl{padding:32px 18px;}
  .nl-form{flex-direction:column;}
  .nl-in{border-right:1px solid var(--border);border-bottom:none;}
  .post-grid{grid-template-columns:1fr;}
  .art-wrap{padding:32px 18px 60px;}
}
@media(max-width:480px){
  .topic-grid{grid-template-columns:1fr 1fr;}
  .hero-brand{font-size:clamp(2.8rem,14vw,5rem);}
}

/* POST VIEW BADGE */
.pc-view-cnt{color:var(--dim);}

/* BG CORNER GLOW */
.bg-glow{position:fixed;inset:0;pointer-events:none;z-index:0;background:radial-gradient(ellipse 55% 45% at 0% 100%,rgba(191,0,255,.09) 0%,transparent 70%),radial-gradient(ellipse 45% 55% at 100% 0%,rgba(0,245,255,.08) 0%,transparent 70%);}

/* TERMINAL CURSOR */
.cursor{display:inline-block;color:var(--cyan);margin-left:2px;animation:cur-blink 1s step-start infinite;}
@keyframes cur-blink{0%,100%{opacity:1;}50%{opacity:0;}}

/* FEATURED CARD */
.pc.featured{grid-column:1/-1;display:grid;grid-template-columns:45% 1fr;}
.pc.featured .pc-img{height:100%;min-height:280px;}
.pc.featured .pc-body{padding:32px;display:flex;flex-direction:column;justify-content:center;}
.pc.featured .pc-title{font-size:1.22rem;line-height:1.5;margin-bottom:16px;}
.pc.featured .pc-exc{-webkit-line-clamp:5;margin-bottom:20px;}
.pc.featured::after{content:'FEATURED';position:absolute;top:12px;right:14px;font-family:'Share Tech Mono',monospace;font-size:.55rem;color:var(--yellow);border:1px solid var(--yellow);padding:2px 8px;letter-spacing:.1em;background:rgba(5,5,16,.85);}

/* TOPIC ICON PULSE */
.tc:hover .tc-icon{animation:icon-pulse .5s ease;}
@keyframes icon-pulse{0%{transform:scale(1);}40%{transform:scale(1.4);}100%{transform:scale(1);}}

@media(max-width:768px){.pc.featured{grid-template-columns:1fr;}.pc.featured .pc-img{min-height:200px;}}

::selection{background:rgba(0,245,255,.2);color:#fff;}
::-webkit-scrollbar{width:4px;}
::-webkit-scrollbar-track{background:var(--bg2);}
::-webkit-scrollbar-thumb{background:rgba(0,245,255,.2);}
</style>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
<div class="bg-glow"></div>

<!-- NAV -->
<nav>
<div class="nav-inner">
  <span class="nav-logo" onclick="goHome()" style="display:flex;align-items:center;gap:8px;"><img src="logo.jpg" alt="æ“ä½œä¸€ä¸‹" style="height:36px;width:36px;object-fit:cover;border-radius:2px;">æ“ä½œä¸€ä¸‹</span>
  <div class="nav-links">
    <button onclick="goHome();gotoSection('posts')">æ–‡ç« </button>
    <a href="podcast.html" class="nav-podcast">Podcast</a>
    <button onclick="goHome();gotoSection('topics')">ä¸»é¡Œ</button>
    <button onclick="goHome();gotoSection('about')">é—œæ–¼æˆ‘</button>
    <button onclick="goHome();gotoSection('newsletter')">è¨‚é–±</button>
  </div>
  <div class="nav-search">
    <span style="color:var(--dim);font-size:.8rem;">ğŸ”</span>
    <input type="text" placeholder="æœå°‹..." id="nav-q" onkeydown="if(event.key==='Enter')runSearch(this.value)">
  </div>
  <button class="hamburger" onclick="toggleMob()" id="ham"><span></span><span></span><span></span></button>
</div>
</nav>

<!-- MOBILE MENU -->
<div class="mob-menu" id="mob-menu">
  <div class="mob-search">
    <input type="text" placeholder="æœå°‹æ–‡ç« ..." id="mob-q" onkeydown="if(event.key==='Enter'){runSearch(this.value);toggleMob();}">
  </div>
  <button onclick="goHome();gotoSection('posts');toggleMob()">æ–‡ç« </button>
  <a href="podcast.html" onclick="toggleMob()" style="font-family:'Share Tech Mono',monospace;font-size:.88rem;color:var(--mid);text-decoration:none;border-bottom:1px solid var(--border);padding:16px 0;text-transform:uppercase;display:block;">Podcast</a>
  <button onclick="goHome();gotoSection('topics');toggleMob()">ä¸»é¡Œ</button>
  <button onclick="goHome();gotoSection('about');toggleMob()">é—œæ–¼æˆ‘</button>
  <button onclick="goHome();gotoSection('newsletter');toggleMob()">è¨‚é–±</button>
</div>

<!-- â•â•â• HOME â•â•â• -->
<div class="view active" id="v-home">

<div class="hero">
  <div class="orb orb1"></div>
  <div class="orb orb2"></div>
  <div class="orb orb3"></div>
  <div class="hero-tag" id="h-tag">å€‹äººå“ç‰Œ Â· è‡ªåª’é«”å‰µä½œè€…</div>
  <div style="margin-bottom:24px;text-align:center;"><img src="logo.jpg" alt="æ“ä½œä¸€ä¸‹" style="width:min(280px,70vw);height:auto;display:inline-block;filter:drop-shadow(0 0 20px rgba(0,245,255,0.4));"></div>
  <div class="hero-brand">
    <span class="t1" data-text="æ“ä½œ" id="h-t1">æ“ä½œ</span><span class="t2" id="h-t2">ä¸€ä¸‹</span>
  </div>
  <div class="hero-sub" id="h-sub"></div>
  <div class="hero-quote" id="h-quote">ç°¡å–®çš„äº‹æƒ…å°ˆæ³¨åšï¼Œ<br>æœ‰ä¸€å¤©ä¸–ç•Œæœƒç‚ºäº†ä½ è€Œæ„Ÿå‹•</div>
  <button class="hero-cta" id="h-cta" onclick="gotoSection('posts')">é–‹å§‹é–±è®€ â†’</button>
</div>

<div class="section" id="posts">
  <div class="sec-hd">
    <div class="sec-hd-text"><h2>æœ€æ–°æ–‡ç« </h2><div class="sec-sub">// latest posts<span class="cursor">â–‹</span></div></div>
    <div class="sec-line"></div>
  </div>
  <div class="filter-bar">
    <button class="fb on" data-cat="" onclick="applyFilter(this,'')">å…¨éƒ¨</button>
    <button class="fb" data-cat="AI" onclick="applyFilter(this,'AI')">AI</button>
    <button class="fb" data-cat="é›²ç«¯" onclick="applyFilter(this,'é›²ç«¯')">é›²ç«¯</button>
    <button class="fb" data-cat="è³‡å®‰" onclick="applyFilter(this,'è³‡å®‰')">è³‡å®‰</button>
    <button class="fb" data-cat="é–±è®€" onclick="applyFilter(this,'é–±è®€')">é–±è®€</button>
    <button class="fb" data-cat="æˆé•·" onclick="applyFilter(this,'æˆé•·')">æˆé•·</button>
  </div>
  <div class="post-grid" id="grid-main"></div>
</div>

<div class="section" id="topics" style="background:rgba(255,255,255,.012);border-top:1px solid var(--border);border-bottom:1px solid var(--border);">
  <div class="sec-hd">
    <div class="sec-hd-text"><h2>æ ¸å¿ƒä¸»é¡Œ</h2><div class="sec-sub">// core topics<span class="cursor">â–‹</span></div></div>
    <div class="sec-line"></div>
  </div>
  <div class="topic-grid">
    <div class="tc" style="border-top-color:var(--cyan);background:linear-gradient(180deg,rgba(0,245,255,.07) 0%,var(--bg2) 60%);" onclick="applyFilterGlobal('é›²ç«¯')">
      <div class="tc-icon">â˜ï¸</div>
      <div class="tc-name" style="color:var(--cyan);">é›²ç«¯</div>
      <div class="tc-desc">AWSã€Azureã€GCP æ¶æ§‹å¯¦æˆ°</div>
      <div class="tc-cnt" style="border-color:var(--cyan);color:var(--cyan);" id="tc-é›²ç«¯">0 ç¯‡</div>
    </div>
    <div class="tc" style="border-top-color:var(--pink);background:linear-gradient(180deg,rgba(255,0,128,.07) 0%,var(--bg2) 60%);" onclick="applyFilterGlobal('è³‡å®‰')">
      <div class="tc-icon">ğŸ”</div>
      <div class="tc-name" style="color:var(--pink);">è³‡å®‰</div>
      <div class="tc-desc">é›¶ä¿¡ä»»ã€æ»²é€æ¸¬è©¦ã€è³‡å®‰è§€å¿µ</div>
      <div class="tc-cnt" style="border-color:var(--pink);color:var(--pink);" id="tc-è³‡å®‰">0 ç¯‡</div>
    </div>
    <div class="tc" style="border-top-color:var(--purple);background:linear-gradient(180deg,rgba(191,0,255,.07) 0%,var(--bg2) 60%);" onclick="applyFilterGlobal('AI')">
      <div class="tc-icon">ğŸ¤–</div>
      <div class="tc-name" style="color:var(--purple);">AI</div>
      <div class="tc-desc">LLM å·¥å…·ã€Promptã€å·¥ä½œæµç¨‹</div>
      <div class="tc-cnt" style="border-color:var(--purple);color:var(--purple);" id="tc-AI">0 ç¯‡</div>
    </div>
    <div class="tc" style="border-top-color:var(--yellow);background:linear-gradient(180deg,rgba(255,255,0,.05) 0%,var(--bg2) 60%);" onclick="applyFilterGlobal('é–±è®€')">
      <div class="tc-icon">ğŸ“š</div>
      <div class="tc-name" style="color:var(--yellow);">é–±è®€</div>
      <div class="tc-desc">æ›¸è©•ã€å¿ƒå¾—ã€çŸ¥è­˜ç®¡ç†</div>
      <div class="tc-cnt" style="border-color:var(--yellow);color:var(--yellow);" id="tc-é–±è®€">0 ç¯‡</div>
    </div>
    <div class="tc" style="border-top-color:var(--green);background:linear-gradient(180deg,rgba(0,255,136,.06) 0%,var(--bg2) 60%);" onclick="applyFilterGlobal('æˆé•·')">
      <div class="tc-icon">ğŸŒ±</div>
      <div class="tc-name" style="color:var(--green);">æˆé•·</div>
      <div class="tc-desc">å€‹äººæˆé•·ã€ç¿’æ…£ã€è‡ªåª’é«”ç¶“ç‡Ÿ</div>
      <div class="tc-cnt" style="border-color:var(--green);color:var(--green);" id="tc-æˆé•·">0 ç¯‡</div>
    </div>
  </div>
</div>

<div class="section" id="about">
  <div class="sec-hd">
    <div class="sec-hd-text"><h2>é—œæ–¼æˆ‘</h2><div class="sec-sub">// about<span class="cursor">â–‹</span></div></div>
    <div class="sec-line"></div>
  </div>
  <div class="about-wrap">
    <div class="avatar">
      <img class="avatar-photo" src="profile.jpg" alt="Jin" id="av-img">
      <div class="avatar-ring"></div>
    </div>
    <div>
      <div class="about-bio" id="a-bio">æˆ‘æ˜¯æ“ä½œä¸€ä¸‹ï¼Œæ·±è€•é›²ç«¯ã€è³‡å®‰èˆ‡ AI çš„è‡ªåª’é«”å‰µä½œè€…ã€‚

æˆ‘ç›¸ä¿¡ç§‘æŠ€ä¸æ‡‰åªæ˜¯å·¥ç¨‹å¸«çš„èªè¨€ï¼Œæ¯å€‹äººéƒ½å€¼å¾—ç†è§£é€™äº›å·¥å…·ã€‚

ä¸è³£èª²ç¨‹ï¼Œä¸è¿½æµé‡ï¼Œåªæƒ³æŠŠæœ‰ç”¨çš„æ±è¥¿èªªæ¸…æ¥šã€‚</div>
      <div class="about-stats">
        <div><div class="stat-n" id="s1n">50+</div><div class="stat-l" id="s1l">ç¯‡æ–‡ç« </div></div>
        <div><div class="stat-n" id="s2n">5</div><div class="stat-l" id="s2l">æ ¸å¿ƒä¸»é¡Œ</div></div>
        <div><div class="stat-n" id="s3n">âˆ</div><div class="stat-l" id="s3l">æŒçºŒæ›´æ–°</div></div>
        <div><div class="stat-n" style="color:var(--pink);text-shadow:0 0 10px var(--pink);" id="stat-total">â€”</div><div class="stat-l">ç´¯ç©ç€è¦½</div></div>
        <div><div class="stat-n" style="color:var(--green);text-shadow:0 0 10px var(--green);" id="stat-today">â€”</div><div class="stat-l">ä»Šæ—¥ç€è¦½</div></div>
      </div>
    </div>
  </div>
</div>

<div class="section" id="newsletter">
  <div class="nl">
    <h2 id="nl-t">è¨‚é–±é›»å­å ±</h2>
    <p id="nl-d">æ¯é€±ç²¾é¸ä¸€ç¯‡æ·±åº¦æ–‡ç« ï¼Œç›´æ¥é€åˆ°ä½ çš„ä¿¡ç®±ã€‚ä¸ç™¼å»£å‘Šï¼Œåªçµ¦å€¼å¾—è®€çš„å…§å®¹ã€‚</p>
    <div class="nl-form">
      <input class="nl-in" type="email" placeholder="your@email.com" id="nl-email">
      <button class="nl-btn" onclick="nlSubmit()">è¨‚é–±</button>
    </div>
  </div>
</div>

</div><!-- /home -->

<!-- â•â•â• ARTICLE â•â•â• -->
<div class="view" id="v-article">
<div class="art-wrap">
  <button class="art-back" onclick="goHome()">â† è¿”å›æ–‡ç« åˆ—è¡¨</button>
  <div class="art-cat-badge" id="a-badge"></div>
  <h1 class="art-title" id="a-title"></h1>
  <div class="art-meta">
    <span>ğŸ“… <span id="a-date"></span></span>
    <span>â± <span id="a-rt"></span> åˆ†é˜é–±è®€</span>
    <span>ğŸ‘ <span id="a-views">0</span> æ¬¡ç€è¦½</span>
    <span id="a-cat-tag"></span>
  </div>
  <img class="art-cover" id="a-cover" style="display:none;" alt="å°é¢åœ–">
  <div class="art-body" id="a-body"></div>
  <div class="share-bar">
    <span class="share-label">åˆ†äº«ï¼š</span>
    <button class="share-btn" onclick="share('twitter')">Twitter / X</button>
    <button class="share-btn" onclick="share('linkedin')">LinkedIn</button>
    <button class="share-btn" onclick="copyURL(this)">è¤‡è£½é€£çµ</button>
  </div>
  <div class="related" id="related">
    <div class="related-lbl">// ç›¸é—œæ–‡ç« </div>
    <div class="related-grid" id="rel-grid"></div>
  </div>
</div>
</div>

<!-- â•â•â• SEARCH â•â•â• -->
<div class="view" id="v-search">
<div class="search-wrap">
  <div class="search-title">æœå°‹æ–‡ç« </div>
  <div class="search-box">
    <input type="text" id="sq" placeholder="è¼¸å…¥é—œéµå­—..." onkeydown="if(event.key==='Enter')runSearch(this.value)">
    <button onclick="runSearch(document.getElementById('sq').value)">æœå°‹</button>
  </div>
  <div class="search-info" id="s-info"></div>
  <div class="post-grid" id="grid-search"></div>
</div>
</div>

<footer id="footer-text">Â© 2025 æ“ä½œä¸€ä¸‹ Â· ç°¡å–®çš„äº‹æƒ…å°ˆæ³¨åš</footer>

<script>
// â”€â”€ SUPABASE â”€â”€
const SUPABASE_URL='https://pvqvnmntqhsfzarbxayf.supabase.co';
const SUPABASE_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB2cXZubW50cWhzZnphcmJ4YXlmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE2NjQ0MjUsImV4cCI6MjA4NzI0MDQyNX0.sKn8yzJos9F8ghKrp3icx6zR2RO39898DenWlLodpqA';
const sb=supabase.createClient(SUPABASE_URL,SUPABASE_KEY);

const CAT_COLOR={AI:'#bf00ff',é›²ç«¯:'#00f5ff',è³‡å®‰:'#ff0080',é–±è®€:'#ffff00',æˆé•·:'#00ff88'};
const CAT_ICON={AI:'ğŸ¤–',é›²ç«¯:'â˜ï¸',è³‡å®‰:'ğŸ”',é–±è®€:'ğŸ“š',æˆé•·:'ğŸŒ±'};

const DEFAULTS={
  posts:[
    {id:1,title:'å¾ GPT åˆ° Claudeï¼š2025 å¹´ AI å·¥å…·é¸æ“‡æŒ‡å—',category:'AI',date:'2025-02-15',status:'published',excerpt:'æ·±å…¥æ¯”è¼ƒä¸»æµ AI åŠ©ç†çš„ä½¿ç”¨å ´æ™¯ï¼Œæ‰¾åˆ°æœ€é©åˆä½ å·¥ä½œæµç¨‹çš„é‚£ä¸€å€‹ã€‚',image:'',body:'<p>2025 å¹´ï¼ŒAI åŠ©ç†å·²ç¶“ä¸å†æ˜¯æ–°å¥‡ç©å…·ï¼Œè€Œæ˜¯çœŸå¯¦å½±éŸ¿å·¥ä½œæ•ˆç‡çš„æ ¸å¿ƒå·¥å…·ã€‚</p>'},
    {id:2,title:'AWS vs Azure vs GCPï¼šé¸æ“‡é›²ç«¯å¹³å°çš„ä¸‰å€‹é—œéµå•é¡Œ',category:'é›²ç«¯',date:'2025-02-08',status:'published',excerpt:'ä¸ç”¨èƒŒæ‰€æœ‰æœå‹™åç¨±ï¼Œåªè¦å•å°å•é¡Œï¼Œä½ å°±çŸ¥é“å“ªå€‹é›²æ›´é©åˆä½ çš„éœ€æ±‚ã€‚',image:'',body:'<p>é›²ç«¯å¹³å°çš„é¸æ“‡å›°æ“¾è‘—å¾ˆå¤šäººï¼Œä½†å…¶å¯¦åªéœ€è¦å•è‡ªå·±ä¸‰å€‹å•é¡Œã€‚</p>'},
    {id:3,title:'é›¶ä¿¡ä»»æ¶æ§‹å…¥é–€ï¼šç‚ºä»€éº¼ã€Œç›¸ä¿¡ä½†é©—è­‰ã€å·²ç¶“éæ™‚äº†',category:'è³‡å®‰',date:'2025-01-29',status:'published',excerpt:'ç¾ä»£è³‡å®‰æ€ç¶­çš„è½‰è®Šï¼Œä»¥åŠä¼æ¥­å¦‚ä½•åœ¨æ··åˆå·¥ä½œæ™‚ä»£ä¿è­·æ•¸ä½é‚Šç•Œã€‚',image:'',body:'<p>é›¶ä¿¡ä»»çš„æ ¸å¿ƒæ˜¯ã€Œæ°¸ä¸ä¿¡ä»»ï¼Œå§‹çµ‚é©—è­‰ã€ã€‚</p>'},
  ],
  hp:{tag:'å€‹äººå“ç‰Œ Â· è‡ªåª’é«”å‰µä½œè€…',t1:'æ“ä½œ',t2:'ä¸€ä¸‹',sub:'operation.tw // é›²ç«¯ Â· è³‡å®‰ Â· AI Â· é–±è®€ Â· æˆé•·',quote:'ç°¡å–®çš„äº‹æƒ…å°ˆæ³¨åšï¼Œ\næœ‰ä¸€å¤©ä¸–ç•Œæœƒç‚ºäº†ä½ è€Œæ„Ÿå‹•',cta:'é–‹å§‹é–±è®€ â†’',nlt:'è¨‚é–±é›»å­å ±',nld:'æ¯é€±ç²¾é¸ä¸€ç¯‡æ·±åº¦æ–‡ç« ï¼Œç›´æ¥é€åˆ°ä½ çš„ä¿¡ç®±ã€‚ä¸ç™¼å»£å‘Šï¼Œåªçµ¦å€¼å¾—è®€çš„å…§å®¹ã€‚'},
  about:{initials:'OP',bio:'æˆ‘æ˜¯æ“ä½œä¸€ä¸‹ï¼Œæ·±è€•é›²ç«¯ã€è³‡å®‰èˆ‡ AI çš„è‡ªåª’é«”å‰µä½œè€…ã€‚\n\næˆ‘ç›¸ä¿¡ç§‘æŠ€ä¸æ‡‰åªæ˜¯å·¥ç¨‹å¸«çš„èªè¨€ï¼Œæ¯å€‹äººéƒ½å€¼å¾—ç†è§£é€™äº›å·¥å…·ã€‚\n\nä¸è³£èª²ç¨‹ï¼Œä¸è¿½æµé‡ï¼Œåªæƒ³æŠŠæœ‰ç”¨çš„æ±è¥¿èªªæ¸…æ¥šã€‚',s1n:'50+',s1l:'ç¯‡æ–‡ç« ',s2n:'5',s2l:'æ ¸å¿ƒä¸»é¡Œ',s3n:'âˆ',s3l:'æŒçºŒæ›´æ–°'},
  footer:'Â© 2025 æ“ä½œä¸€ä¸‹ Â· ç°¡å–®çš„äº‹æƒ…å°ˆæ³¨åš'
};

let D={posts:[],hp:DEFAULTS.hp,about:DEFAULTS.about,footer:DEFAULTS.footer};

// â”€â”€ DB INIT â”€â”€
async function initDB(){
  const today=new Date().toISOString().slice(0,10);
  try{
    const [pr,sr]=await Promise.all([
      sb.from('posts').select('*').eq('status','published').order('date',{ascending:false}),
      sb.from('settings').select('*')
    ]);
    if(pr.error)throw pr.error;
    if(sr.error)console.warn('Settings query error:',sr.error);
    const sm={};
    (sr.data||[]).forEach(s=>{sm[s.key]=s.value;});
    D={
      posts:pr.data||[],
      hp:sm.hp||DEFAULTS.hp,
      about:sm.about||DEFAULTS.about,
      footer:(sm.footer&&sm.footer.text)||DEFAULTS.footer,
      siteViews:{total:0,today:0}
    };
  }catch(err){
    console.error('Supabase error:',err);
    D=JSON.parse(JSON.stringify(DEFAULTS));
    D.siteViews={total:0,today:0};
  }
  renderHome();
  handleRoute();
  // å…ˆéå¢ç€è¦½æ•¸ï¼Œå†æŸ¥è©¢çµ±è¨ˆï¼ˆç¢ºä¿è³‡æ–™å·²å¯«å…¥ï¼‰
  sb.rpc('increment_site_views').then(({error:incErr})=>{
    if(incErr)console.warn('increment_site_views error:',incErr);
    return sb.from('site_stats').select('*').in('id',['total',today]);
  },e=>{console.warn('increment_site_views failed:',e);return sb.from('site_stats').select('*').in('id',['total',today]);})
  .then(({data,error})=>{
    if(error){console.warn('site_stats query error:',error);return;}
    if(data&&data.length){
      data.forEach(s=>{if(s.id==='total')D.siteViews.total=s.count;else D.siteViews.today=s.count;});
      setText('stat-total',fmtViews(D.siteViews.total));
      setText('stat-today',fmtViews(D.siteViews.today));
    }else{
      console.warn('site_stats: no data returned',data);
    }
  });
}

/* â”€â”€ RENDER HOME â”€â”€ */
let _twDone=false;
function renderHome(){
  const h=D.hp||{};
  setText('h-tag',h.tag);setText('h-t1',h.t1);setText('h-t2',h.t2);
  if(!_twDone){typewrite('h-sub',h.sub||'');}else{setText('h-sub',h.sub);}
  setHTML('h-quote',(h.quote||'').replace(/\n/g,'<br>'));
  setText('h-cta',h.cta);
  const q=document.getElementById('h-t1');if(q)q.setAttribute('data-text',h.t1||'æ“ä½œ');
  const a=D.about||{};
  setHTML('a-bio',(a.bio||'').replace(/\n/g,'<br>'));
  setText('s1n',a.s1n);setText('s1l',a.s1l);
  setText('s2n',a.s2n);setText('s2l',a.s2l);
  setText('s3n',a.s3n);setText('s3l',a.s3l);
  setText('nl-t',h.nlt);setText('nl-d',h.nld);
  setText('footer-text',D.footer||'');
  const sv=D.siteViews||{total:0,today:0};
  setText('stat-total',fmtViews(sv.total));
  setText('stat-today',fmtViews(sv.today));
  updateTopicCounts();
  renderGrid('grid-main',publishedPosts());
  initCountUp();
}

function setText(id,v){const e=document.getElementById(id);if(e&&v!=null)e.textContent=v;}
function setHTML(id,v){const e=document.getElementById(id);if(e&&v!=null)e.innerHTML=v;}

function publishedPosts(cat){
  return (D.posts||[]).filter(p=>!cat||p.category===cat).sort((a,b)=>new Date(b.date)-new Date(a.date));
}

function updateTopicCounts(){
  ['é›²ç«¯','è³‡å®‰','AI','é–±è®€','æˆé•·'].forEach(c=>{
    const el=document.getElementById('tc-'+c);
    if(el)el.textContent=publishedPosts(c).length+' ç¯‡';
  });
}

/* â”€â”€ GRID â”€â”€ */
function renderGrid(containerId,posts){
  const g=document.getElementById(containerId);if(!g)return;
  if(!posts.length){g.innerHTML='<div class="empty-state"><div class="ei">ğŸ“­</div><p>ç›®å‰æ²’æœ‰æ–‡ç« </p></div>';return;}
  const isMaster=containerId==='grid-main';
  g.innerHTML=posts.map((p,i)=>cardHTML(p,isMaster&&i===0)).join('');
}

function cardHTML(p,featured){
  const c=CAT_COLOR[p.category]||'#aaa';
  const icon=CAT_ICON[p.category]||'ğŸ“„';
  const rt=readTime(p.body);
  const img=p.image?'<img src="'+esc(p.image)+'" alt="'+esc(p.title)+'" style="width:100%;height:100%;object-fit:cover;">'
    :'<span class="pc-img-ph">'+icon+'</span>';
  const cls=featured?'pc featured':'pc';
  return '<div class="'+cls+'" onclick="openPost(\''+p.id+'\')" style="border-left:3px solid '+c+';">'
    +'<div class="pc-img">'+img+'<span class="pc-badge" style="border-color:'+c+';color:'+c+';">'+esc(p.category)+'</span></div>'
    +'<div class="pc-body"><div class="pc-title">'+esc(p.title)+'</div>'
    +'<div class="pc-exc">'+esc(p.excerpt||'')+'</div>'
    +'<div class="pc-foot"><span>ğŸ“… '+esc(p.date)+'</span><span class="pc-view-cnt">ğŸ‘ '+(p.views||0)+'</span><span class="pc-rt">â± '+rt+' åˆ†é˜</span></div>'
    +'</div></div>';
}

function readTime(html){return Math.max(1,Math.round(((html||'').replace(/<[^>]+>/g,'').length)/300));}

/* â”€â”€ FILTER â”€â”€ */
function applyFilter(btn,cat){
  document.querySelectorAll('#posts .fb').forEach(b=>b.classList.toggle('on',b===btn));
  renderGrid('grid-main',publishedPosts(cat));
}
function applyFilterGlobal(cat){
  goHome();
  setTimeout(()=>{
    const btn=document.querySelector('#posts .fb[data-cat="'+cat+'"]');
    if(btn)applyFilter(btn,cat);
    gotoSection('posts');
  },80);
}

/* â”€â”€ OPEN POST â”€â”€ */
function openPost(id){
  const p=(D.posts||[]).find(x=>x.id==id);if(!p)return;
  const c=CAT_COLOR[p.category]||'#aaa';
  const badge=document.getElementById('a-badge');
  badge.textContent=p.category;badge.style.borderColor=c;badge.style.color=c;
  p.views=(p.views||0)+1;
  setText('a-title',p.title);setText('a-date',p.date);setText('a-rt',readTime(p.body));setText('a-cat-tag','ğŸ· '+p.category);
  setText('a-views',p.views);
  sb.rpc('increment_post_views',{post_id:p.id}).then(()=>{},()=>{});
  const cover=document.getElementById('a-cover');
  if(p.image){cover.src=p.image;cover.style.display='block';}else{cover.style.display='none';}
  document.getElementById('a-body').innerHTML=p.body||'<p style="color:var(--dim)">ï¼ˆå°šç„¡å…§å®¹ï¼‰</p>';
  const rel=publishedPosts(p.category).filter(x=>x.id!=id).slice(0,3);
  const rg=document.getElementById('rel-grid'),rs=document.getElementById('related');
  if(rel.length){
    rg.innerHTML=rel.map(r=>{
      const rc=CAT_COLOR[r.category]||'#aaa';
      return '<div class="rel-card" onclick="openPost(\''+r.id+'\')">'
        +'<div class="rel-cat" style="color:'+rc+';">'+esc(r.category)+'</div>'
        +'<div class="rel-title">'+esc(r.title)+'</div></div>';
    }).join('');
    rs.style.display='block';
  }else rs.style.display='none';
  showView('article');window.scrollTo(0,0);
  const slug=p.slug||p.id;
  setPostMeta(p);
  if(location.pathname!=='/post/'+encodeURIComponent(slug)) history.pushState(null,'','/post/'+encodeURIComponent(slug));
}

/* â”€â”€ VIEWS â”€â”€ */
function showView(name){document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));document.getElementById('v-'+name).classList.add('active');}
function goHome(){showView('home');renderHome();resetMeta();if(location.pathname!=='/')history.pushState(null,'','/');}

/* â”€â”€ ROUTE â”€â”€ */
function handleRoute(){
  const path=location.pathname;
  if(path.startsWith('/post/')){
    const key=decodeURIComponent(path.slice(6));
    const p=(D.posts||[]).find(x=>(x.slug&&x.slug===key)||String(x.id)===key);
    if(p){openPost(p.id);return;}
  }
  goHome();
}
window.addEventListener('popstate',handleRoute);
function gotoSection(id){setTimeout(()=>{const e=document.getElementById(id);if(e)e.scrollIntoView({behavior:'smooth'});},120);}

/* â”€â”€ SEARCH â”€â”€ */
function runSearch(q){
  q=(q||'').trim();if(!q)return;
  document.getElementById('sq').value=q;document.getElementById('nav-q').value=q;
  const r=publishedPosts().filter(p=>[p.title,p.excerpt||'',(p.body||'').replace(/<[^>]+>/g,'')].join(' ').toLowerCase().includes(q.toLowerCase()));
  setText('s-info','æ‰¾åˆ° '+r.length+' ç¯‡ï¼Œé—œéµå­—ï¼šã€Œ'+q+'ã€');
  renderGrid('grid-search',r);showView('search');window.scrollTo(0,0);
}

/* â”€â”€ SHARE â”€â”€ */
function share(platform){
  const url=encodeURIComponent(location.href),title=encodeURIComponent(document.getElementById('a-title').textContent);
  const urls={twitter:'https://twitter.com/intent/tweet?text='+title+'&url='+url,linkedin:'https://www.linkedin.com/sharing/share-offsite/?url='+url};
  window.open(urls[platform],'_blank');
}
function copyURL(btn){
  navigator.clipboard.writeText(location.href).then(()=>{btn.textContent='å·²è¤‡è£½ âœ“';setTimeout(()=>btn.textContent='è¤‡è£½é€£çµ',2000);});
}

/* â”€â”€ SEO / SCHEMA â”€â”€ */
function setPostMeta(p){
  const slug=p.slug||p.id;
  const url='https://operation.tw/post/'+encodeURIComponent(slug);
  document.title=(p.title||'æ–‡ç« ')+' | æ“ä½œä¸€ä¸‹';
  const metaDesc=document.querySelector('meta[name="description"]');
  if(metaDesc)metaDesc.content=p.excerpt||p.title||'';
  const canonical=document.querySelector('link[rel="canonical"]');
  if(canonical)canonical.href=url;
  const schema={
    '@context':'https://schema.org','@type':'BlogPosting',
    'headline':p.title||'','description':p.excerpt||'',
    'datePublished':p.date||'','dateModified':p.date||'',
    'author':{'@type':'Person','name':'æ“ä½œä¸€ä¸‹','url':'https://operation.tw'},
    'publisher':{'@type':'Organization','name':'æ“ä½œä¸€ä¸‹','url':'https://operation.tw'},
    'url':url,'mainEntityOfPage':{'@type':'WebPage','@id':url},
    'articleSection':p.category||'','keywords':p.category||''
  };
  if(p.image)schema.image=p.image;
  let el=document.getElementById('ld-article');
  if(!el){el=document.createElement('script');el.type='application/ld+json';el.id='ld-article';document.head.appendChild(el);}
  el.textContent=JSON.stringify(schema);
  /* OG / Twitter Card */
  const img=p.image||'https://operation.tw/default.png';
  const desc=p.excerpt||p.title||'';
  const ogMap={'og:type':'article','og:title':p.title||'','og:description':desc,'og:url':url,'og:image':img};
  Object.entries(ogMap).forEach(([k,v])=>{let m=document.querySelector('meta[property="'+k+'"]');if(m)m.content=v;});
  const twMap={'twitter:card':'summary_large_image','twitter:title':p.title||'','twitter:description':desc,'twitter:image':img};
  Object.entries(twMap).forEach(([k,v])=>{let m=document.querySelector('meta[name="'+k+'"]');if(m)m.content=v;});
}
function resetMeta(){
  document.title='æ“ä½œä¸€ä¸‹ | operation.tw';
  const metaDesc=document.querySelector('meta[name="description"]');
  if(metaDesc)metaDesc.content='é›²ç«¯ã€è³‡å®‰ã€AIã€é–±è®€ã€æˆé•· â€” ç°¡å–®çš„äº‹æƒ…å°ˆæ³¨åš';
  const canonical=document.querySelector('link[rel="canonical"]');
  if(canonical)canonical.href='https://operation.tw/';
  const el=document.getElementById('ld-article');if(el)el.remove();
  /* Reset OG / Twitter Card */
  const t='æ“ä½œä¸€ä¸‹ | operation.tw',d='é›²ç«¯ã€è³‡å®‰ã€AIã€é–±è®€ã€æˆé•· â€” ç°¡å–®çš„äº‹æƒ…å°ˆæ³¨åš',img='https://operation.tw/default.png';
  const ogDef={'og:type':'website','og:title':t,'og:description':d,'og:url':'https://operation.tw/','og:image':img};
  Object.entries(ogDef).forEach(([k,v])=>{let m=document.querySelector('meta[property="'+k+'"]');if(m)m.content=v;});
  const twDef={'twitter:card':'summary_large_image','twitter:title':t,'twitter:description':d,'twitter:image':img};
  Object.entries(twDef).forEach(([k,v])=>{let m=document.querySelector('meta[name="'+k+'"]');if(m)m.content=v;});
}

/* â”€â”€ NEWSLETTER â”€â”€ */
function nlSubmit(){
  const inp=document.getElementById('nl-email');
  if(!inp.value.includes('@')){inp.style.borderColor='var(--pink)';return;}
  inp.style.borderColor='';
  const btn=inp.nextElementSibling;
  btn.textContent='è¨‚é–±æˆåŠŸ âœ“';btn.style.background='var(--green)';inp.value='';
  setTimeout(()=>{btn.textContent='è¨‚é–±';btn.style.background='';},3000);
}

/* â”€â”€ MOBILE MENU â”€â”€ */
function toggleMob(){document.getElementById('mob-menu').classList.toggle('open');}

/* â”€â”€ TYPEWRITER â”€â”€ */
function typewrite(id,text){
  const el=document.getElementById(id);if(!el)return;
  el.textContent='';let i=0;
  function tick(){if(i<text.length){el.textContent+=text[i++];setTimeout(tick,28);}else{_twDone=true;}}
  tick();
}

/* â”€â”€ COUNT UP â”€â”€ */
function countUp(id,target){
  const el=document.getElementById(id);if(!el)return;
  const num=parseInt(target);if(isNaN(num)){el.textContent=target;return;}
  const hasPlus=String(target).includes('+');
  const dur=1200;const t0=performance.now();
  function frame(now){
    const p=Math.min((now-t0)/dur,1);
    const eased=1-Math.pow(1-p,3);
    el.textContent=Math.floor(eased*num)+(p>=1&&hasPlus?'+':'');
    if(p<1)requestAnimationFrame(frame);
  }
  requestAnimationFrame(frame);
}

let _cuInit=false;
function initCountUp(){
  if(_cuInit)return;_cuInit=true;
  const about=document.getElementById('about');if(!about)return;
  const io=new IntersectionObserver(entries=>{
    if(entries[0].isIntersecting){
      const a=D.about||{};
      countUp('s1n',a.s1n);countUp('s2n',a.s2n);countUp('s3n',a.s3n);
      io.disconnect();
    }
  },{threshold:0.3});
  io.observe(about);
}

/* â”€â”€ UTILS â”€â”€ */
function esc(s){return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
function fmtViews(n){n=+n||0;if(n>=10000)return Math.floor(n/1000)+'k+';if(n>=1000)return (n/1000).toFixed(1)+'k';return String(n);}

/* â”€â”€ INIT â”€â”€ */
initDB();
</script>
</body>
</html>
